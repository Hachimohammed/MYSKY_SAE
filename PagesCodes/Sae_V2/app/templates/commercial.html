<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Commercial - MySky Audio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal.active {
            display: flex;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 min-h-screen">
    
    <!-- Header avec logo -->
    <div class="bg-white/10 backdrop-blur-sm border-b border-white/20">
        <div class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <!-- Logo MySky - Remplacez le src par votre logo -->
                <div class="w-12 h-12 rounded-xl overflow-hidden">
                    <img 
                        src="{{ url_for('static', filename='Logo3.png') }}" 
                        alt="MySky Audio Logo" 
                        class="w-full h-full object-contain"
                    />
                </div>
                <div>
                    <h1 class="text-xl font-bold text-white">MySky Audio</h1>
                    <p class="text-xs text-blue-200">Service Commercial</p>
                </div>
            </div>
            <a href="{{ url_for('logout') }}">
            <button class="px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors text-sm font-medium">
                D√©connexion
            </button>
                                </a>
        </div>
    </div>

    <div class="container mx-auto px-6 py-8">
        <!-- Titre principal -->
        <div class="mb-10">
            <h2 class="text-5xl font-bold text-white mb-2 text-center">SERVICE COMMERCIAL</h2>
            <p class="text-blue-200 text-center text-lg mt-2">Gestion des interruptions publicitaires</p>
        </div>

        <!-- Player Audio Visible - Ultra Moderne -->
        <div class="relative bg-gradient-to-br from-purple-600 via-pink-500 to-orange-500 rounded-3xl shadow-2xl p-1 max-w-5xl mx-auto mb-8 overflow-hidden">
            <!-- Effet glassmorphism -->
            <div class="absolute inset-0 bg-white/10 backdrop-blur-3xl"></div>
            
            <!-- Particules anim√©es en arri√®re-plan -->
            <div class="absolute inset-0 overflow-hidden opacity-30">
                <div class="absolute w-72 h-72 bg-white rounded-full blur-3xl animate-pulse" style="top: -100px; left: -100px;"></div>
                <div class="absolute w-96 h-96 bg-yellow-300 rounded-full blur-3xl animate-pulse" style="bottom: -150px; right: -150px; animation-delay: 1s;"></div>
            </div>

            <div class="relative bg-gradient-to-br from-slate-900/90 to-slate-800/90 backdrop-blur-xl rounded-2xl p-8">
                <!-- Header du player -->
                <div class="flex items-start justify-between mb-6">
                    <div class="flex items-center gap-4">
                        <div class="relative">
                            <!-- Vinyle tournant -->
                            <div class="w-24 h-24 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center shadow-2xl" style="animation: spin 3s linear infinite;">
                                <div class="w-20 h-20 rounded-full bg-slate-900 flex items-center justify-center">
                                    <div class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-400 to-pink-400"></div>
                                </div>
                            </div>
                            <!-- Indicateur de lecture pulsant -->
                            <div class="absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center shadow-lg animate-pulse">
                                <div class="w-3 h-3 bg-white rounded-full"></div>
                            </div>
                        </div>
                        <div>
                            <p class="text-purple-300 text-xs font-semibold mb-1 tracking-wider uppercase">üéµ En lecture</p>
                            <h3 id="currentTrack" class="text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-300 via-pink-300 to-orange-300 mb-1">Summer Vibes - Track 04</h3>
                            <p class="text-gray-400 text-sm">Playlist MySky ¬∑ Ambiance Magasin</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="px-4 py-2 bg-purple-500/20 backdrop-blur-sm text-purple-200 rounded-full text-xs font-bold border border-purple-400/30">
                            üìç 3 appareils
                        </span>
                        <span class="px-4 py-2 bg-green-500/20 backdrop-blur-sm text-green-200 rounded-full text-xs font-bold border border-green-400/30 animate-pulse">
                            üî¥ LIVE
                        </span>
                    </div>
                </div>

                <!-- Barre de progression √©l√©gante -->
                <div class="mb-6">
                    <div class="relative bg-slate-700/50 rounded-full h-2 mb-2 overflow-hidden group cursor-pointer">
                        <div id="progressBar" class="absolute top-0 left-0 h-full bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 rounded-full transition-all shadow-lg" style="width: 45%"></div>
                        <div id="progressGlow" class="absolute top-0 left-0 h-full bg-gradient-to-r from-purple-400 via-pink-400 to-orange-400 rounded-full blur-sm opacity-60 transition-all" style="width: 45%"></div>
                    </div>
                    <div class="flex justify-between items-center">
                        <span id="currentTime" class="text-purple-300 text-sm font-bold">2:15</span>
                        <span class="text-gray-500 text-xs">‚óè‚óè‚óè</span>
                        <span id="totalTime" class="text-gray-400 text-sm font-bold">5:00</span>
                    </div>
                </div>

                <!-- Contr√¥les ultra modernes -->
                <div class="flex items-center justify-between gap-6">
                    <!-- Boutons de navigation -->
                    <div class="flex items-center gap-3">
                        <button class="group w-12 h-12 bg-gradient-to-br from-slate-700 to-slate-600 hover:from-purple-600 hover:to-pink-600 rounded-xl flex items-center justify-center transition-all shadow-lg hover:shadow-purple-500/50 hover:scale-110">
                            <svg class="w-5 h-5 text-gray-300 group-hover:text-white transition-colors" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M8.445 14.832A1 1 0 0010 14v-2.798l5.445 3.63A1 1 0 0017 14V6a1 1 0 00-1.555-.832L10 8.798V6a1 1 0 00-1.555-.832l-6 4a1 1 0 000 1.664l6 4z"/>
                            </svg>
                        </button>
                        
                        <!-- Bouton Play/Pause central XXL -->
                        <button id="playPauseBtn" class="relative group w-20 h-20 bg-gradient-to-br from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 rounded-2xl flex items-center justify-center transition-all shadow-2xl hover:shadow-purple-500/50 hover:scale-110">
                            <div class="absolute inset-0 bg-gradient-to-br from-purple-400 to-pink-400 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity"></div>
                            <svg id="pauseIcon" class="relative w-10 h-10 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                            </svg>
                        </button>

                        <button class="group w-12 h-12 bg-gradient-to-br from-slate-700 to-slate-600 hover:from-purple-600 hover:to-pink-600 rounded-xl flex items-center justify-center transition-all shadow-lg hover:shadow-purple-500/50 hover:scale-110">
                            <svg class="w-5 h-5 text-gray-300 group-hover:text-white transition-colors" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M4.555 5.168A1 1 0 003 6v8a1 1 0 001.555.832L10 11.202V14a1 1 0 001.555.832l6-4a1 1 0 000-1.664l-6-4A1 1 0 0010 6v2.798l-5.445-3.63z"/>
                            </svg>
                        </button>
                    </div>

                    <!-- Contr√¥le du volume moderne -->
                    <div class="flex-1 flex items-center gap-4 max-w-xs">
                        <svg class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                        <input 
                            type="range" 
                            id="volumeSlider" 
                            min="0" 
                            max="100" 
                            value="75" 
                            class="flex-1 h-2 bg-slate-700/50 rounded-full appearance-none cursor-pointer slider"
                            style="background: linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(236, 72, 153) 75%, rgb(71, 85, 105) 75%, rgb(71, 85, 105) 100%);"
                            oninput="updateVolume(this.value)"
                        >
                        <span id="volumeValue" class="text-purple-300 text-sm font-bold min-w-[3rem] text-right">75%</span>
                        <button onclick="toggleMute()" id="muteBtn" class="w-10 h-10 bg-slate-700/50 hover:bg-purple-600 rounded-lg flex items-center justify-center transition-all">
                            <svg id="volumeIcon" class="w-5 h-5 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <style>
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
            
            /* Style du slider de volume */
            input[type="range"].slider::-webkit-slider-thumb {
                appearance: none;
                width: 18px;
                height: 18px;
                border-radius: 50%;
                background: linear-gradient(135deg, #a855f7, #ec4899);
                cursor: pointer;
                box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
                transition: all 0.2s;
            }
            
            input[type="range"].slider::-webkit-slider-thumb:hover {
                transform: scale(1.2);
                box-shadow: 0 0 20px rgba(168, 85, 247, 0.8);
            }
            
            input[type="range"].slider::-moz-range-thumb {
                width: 18px;
                height: 18px;
                border-radius: 50%;
                background: linear-gradient(135deg, #a855f7, #ec4899);
                cursor: pointer;
                border: none;
                box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
                transition: all 0.2s;
            }
            
            input[type="range"].slider::-moz-range-thumb:hover {
                transform: scale(1.2);
                box-shadow: 0 0 20px rgba(168, 85, 247, 0.8);
            }
        </style>

        <!-- Section t√©l√©versement publicit√© -->
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-5xl mx-auto mb-8">
            <div class="flex items-center gap-4 mb-6">
                <div class="w-14 h-14 bg-blue-500 rounded-xl flex items-center justify-center">
                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                </div>
                <div>
                    <h3 class="text-2xl font-bold text-gray-900">Diffuser une publicit√© urgente</h3>
                    <p class="text-gray-600">La musique s'arr√™tera automatiquement et reprendra apr√®s la diffusion</p>
                </div>
            </div>

            <div class="border-3 border-dashed border-blue-300 rounded-2xl p-8 bg-blue-50 hover:bg-blue-100 transition-colors cursor-pointer" onclick="document.getElementById('fileInput').click()">
                <input type="file" id="fileInput" accept=".mp3" class="hidden" onchange="handleFileSelect(event)">
                <div class="text-center">
                    <svg class="w-16 h-16 text-blue-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                    <p class="text-xl font-bold text-gray-900 mb-2">Cliquez pour t√©l√©verser un fichier MP3</p>
                    <p class="text-gray-600 mb-4">ou glissez-d√©posez votre fichier ici</p>
                    <p class="text-sm text-gray-500">Formats accept√©s : .mp3 | Taille max : 50MB</p>
                </div>
            </div>

            <div id="filePreview" class="hidden mt-6">
                <div class="bg-gradient-to-r from-green-50 to-green-100 rounded-2xl p-6 border-2 border-green-300">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <div class="w-14 h-14 bg-green-500 rounded-xl flex items-center justify-center">
                                <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"/>
                                </svg>
                            </div>
                            <div>
                                <p class="font-bold text-gray-900 text-lg" id="fileName">message.mp3</p>
                                <p class="text-gray-600 text-sm">Fichier pr√™t √† √™tre diffus√©</p>
                            </div>
                        </div>
                        <button onclick="diffuserPublicite()" class="px-8 py-3 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center gap-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"/>
                            </svg>
                            DIFFUSER (musique s'arr√™te automatiquement)
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Historique des interruptions -->
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-5xl mx-auto">
            <h3 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-3">
                <svg class="w-7 h-7 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Historique des interruptions publicitaires
            </h3>
            <div class="space-y-3">
                <div class="flex items-center justify-between p-5 bg-orange-50 rounded-xl border-2 border-orange-200">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"/>
                            </svg>
                        </div>
                        <div>
                            <p class="font-bold text-gray-900 text-lg">vente_flash_50%.mp3</p>
                            <p class="text-sm text-gray-600">Diffus√©e il y a 25 minutes</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="px-4 py-2 bg-green-100 text-green-700 font-bold rounded-lg text-sm">‚úì Termin√©e</span>
                        <p class="text-gray-600 text-sm mt-1">Dur√©e: 0:45</p>
                    </div>
                </div>

                <div class="flex items-center justify-between p-5 bg-orange-50 rounded-xl border-2 border-orange-200">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"/>
                            </svg>
                        </div>
                        <div>
                            <p class="font-bold text-gray-900 text-lg">promo_weekend.mp3</p>
                            <p class="text-sm text-gray-600">Diffus√©e il y a 2 heures</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="px-4 py-2 bg-green-100 text-green-700 font-bold rounded-lg text-sm">‚úì Termin√©e</span>
                        <p class="text-gray-600 text-sm mt-1">Dur√©e: 1:15</p>
                    </div>
                </div>

                <div class="flex items-center justify-between p-5 bg-gray-50 rounded-xl border-2 border-gray-200">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-gray-400 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"/>
                            </svg>
                        </div>
                        <div>
                            <p class="font-bold text-gray-900 text-lg">nouvelle_collection.mp3</p>
                            <p class="text-sm text-gray-600">Diffus√©e hier √† 15:30</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="px-4 py-2 bg-green-100 text-green-700 font-bold rounded-lg text-sm">‚úì Termin√©e</span>
                        <p class="text-gray-600 text-sm mt-1">Dur√©e: 0:30</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmation d'interruption -->
    <div id="interruptModal" class="modal">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full mx-4">
            <div class="text-center mb-6">
                <div class="w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse">
                    <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"/>
                    </svg>
                </div>
                <h3 class="text-3xl font-bold text-gray-900 mb-3">Diffusion de la publicit√© en cours...</h3>
                <p class="text-gray-600 text-lg mb-4" id="adFileName">spot_promo.mp3</p>
                
                <!-- Barre de progression pub -->
                <div class="bg-orange-100 rounded-full h-4 mb-2 overflow-hidden">
                    <div id="adProgress" class="bg-orange-500 h-full rounded-full transition-all" style="width: 0%"></div>
                </div>
                <p class="text-gray-600">La musique reprendra automatiquement apr√®s la publicit√©</p>
            </div>

            <div class="bg-blue-50 rounded-2xl p-5 mb-6 border-2 border-blue-200">
                <p class="text-gray-700 text-center">
                    <strong>üìª Diffusion sur :</strong> 3 appareils<br>
                    <strong>‚è∏Ô∏è Musique :</strong> En pause temporaire<br>
                    <strong>‚è±Ô∏è Dur√©e estim√©e :</strong> <span id="adDuration">0:45</span>
                </p>
            </div>

            <button onclick="closeModal()" class="w-full px-6 py-4 bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold rounded-xl transition-all">
                Fermer
            </button>
        </div>
    </div>

    <script>
        let isPlaying = true;
        let selectedFile = null;
        let currentVolume = 75;
        let isMuted = false;
        let volumeBeforeMute = 75;

        // Simulation de progression de la musique
        setInterval(() => {
            if (isPlaying) {
                const progressBar = document.getElementById('progressBar');
                const progressGlow = document.getElementById('progressGlow');
                let currentWidth = parseFloat(progressBar.style.width) || 45;
                currentWidth += 0.5;
                if (currentWidth >= 100) currentWidth = 0;
                progressBar.style.width = currentWidth + '%';
                progressGlow.style.width = currentWidth + '%';
                
                // Mise √† jour du temps
                const totalSeconds = Math.floor((currentWidth / 100) * 300); // 5 min = 300 sec
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = totalSeconds % 60;
                document.getElementById('currentTime').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }, 1000);

        // Gestion du volume
        function updateVolume(value) {
            currentVolume = value;
            document.getElementById('volumeValue').textContent = value + '%';
            
            // Mise √† jour du gradient du slider
            const slider = document.getElementById('volumeSlider');
            slider.style.background = `linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(236, 72, 153) ${value}%, rgb(71, 85, 105) ${value}%, rgb(71, 85, 105) 100%)`;
            
            // Changer l'ic√¥ne selon le volume
            updateVolumeIcon(value);
        }

        function updateVolumeIcon(volume) {
            const icon = document.getElementById('volumeIcon');
            if (volume == 0) {
                icon.innerHTML = '<path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z" clip-rule="evenodd"/>';
            } else if (volume < 50) {
                icon.innerHTML = '<path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z" clip-rule="evenodd"/>';
            } else {
                icon.innerHTML = '<path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"/>';
            }
        }

        function toggleMute() {
            const slider = document.getElementById('volumeSlider');
            const muteBtn = document.getElementById('muteBtn');
            
            if (!isMuted) {
                // Mute
                volumeBeforeMute = currentVolume;
                updateVolume(0);
                slider.value = 0;
                muteBtn.classList.add('bg-red-600');
                muteBtn.classList.remove('bg-slate-700/50');
                isMuted = true;
            } else {
                // Unmute
                updateVolume(volumeBeforeMute);
                slider.value = volumeBeforeMute;
                muteBtn.classList.remove('bg-red-600');
                muteBtn.classList.add('bg-slate-700/50');
                isMuted = false;
            }
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file && file.type === 'audio/mpeg') {
                selectedFile = file;
                document.getElementById('fileName').textContent = file.name;
                document.getElementById('filePreview').classList.remove('hidden');
            } else {
                alert('‚ö†Ô∏è Veuillez s√©lectionner un fichier MP3 valide');
            }
        }

        function diffuserPublicite() {
            if (!selectedFile) return;
            
            // Arr√™t automatique de la musique
            isPlaying = false;
            
            // Afficher la modal de diffusion
            document.getElementById('adFileName').textContent = selectedFile.name;
            document.getElementById('interruptModal').classList.add('active');
            
            // Simuler la progression de la pub
            let progress = 0;
            const adInterval = setInterval(() => {
                progress += 2;
                document.getElementById('adProgress').style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(adInterval);
                    setTimeout(() => {
                        // Reprendre la musique automatiquement
                        isPlaying = true;
                        closeModal();
                        
                        // Ajouter √† l'historique
                        addToHistory(selectedFile.name);
                        
                        // R√©initialiser
                        document.getElementById('filePreview').classList.add('hidden');
                        document.getElementById('fileInput').value = '';
                        selectedFile = null;
                        
                        alert('‚úÖ Publicit√© diffus√©e avec succ√®s!\n\nüéµ La musique a repris automatiquement sur tous les appareils.');
                    }, 500);
                }
            }, 100);
        }

        function addToHistory(fileName) {
            const historyContainer = document.querySelector('.space-y-3');
            const newEntry = document.createElement('div');
            newEntry.className = 'flex items-center justify-between p-5 bg-orange-50 rounded-xl border-2 border-orange-200';
            newEntry.innerHTML = `
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"/>
                        </svg>
                    </div>
                    <div>
                        <p class="font-bold text-gray-900 text-lg">${fileName}</p>
                        <p class="text-sm text-gray-600">Diffus√©e √† l'instant</p>
                    </div>
                </div>
                <div class="text-right">
                    <span class="px-4 py-2 bg-green-100 text-green-700 font-bold rounded-lg text-sm">‚úì Termin√©e</span>
                    <p class="text-gray-600 text-sm mt-1">Dur√©e: 0:45</p>
                </div>
            `;
            historyContainer.insertBefore(newEntry, historyContainer.firstChild);
        }

        function showInterruptModal() {
            document.getElementById('interruptModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('interruptModal').classList.remove('active');
            document.getElementById('adProgress').style.width = '0%';
        }

        function confirmInterrupt() {
            alert('‚è∏Ô∏è Playlist interrompue sur tous les appareils!\n\nVous pouvez maintenant t√©l√©verser votre publicit√©.');
            closeModal();
        }

        // Fermer la modal en cliquant en dehors
        document.getElementById('interruptModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>

</body>
</html>